version: "3.7"
services: 
  
  service_1: 
    image: hifzazaheer96/service_1:latest
    environment:
      - MYSQL=${MYSQL}
      - USER=${USER}
      - PASSWORD=${PASSWORD}
      - DATABASE=${DATABASE}
    networks:
      - ingress 
    deploy:
      replicas: 3

  service_2: 
    image: hifzazaheer96/service_2:latest
    networks:
      - ingress 
    deploy:
      replicas: 1

  service_3: 
    image: hifzazaheer96/service_3:latest
    networks:
      - ingress 
    deploy:
      replicas: 1

  service_4: 
    image: hifzazaheer96/service_4:latest
    networks:
      - ingress 
    deploy:
      replicas: 3

  service_nginx:
    image: hifzazaheer96/nginx:latest
    ports:
      - "80:80"
    networks:
      - ingress
    depends_on:
      - service_1
      - service_2
      - service_3
      - service_4
    deploy:
      replicas: 3
   
networks:
  ingress :
    driver: overlay



